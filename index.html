<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notes and Tasks App</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        .hidden {
            display: none;
        }
        .task-done {
            text-decoration: line-through;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Notes and Tasks App</h1>
        <nav>
            <button onclick="showPage('notes')">Notes</button>
            <button onclick="showPage('tasks')">Tasks</button>
        </nav>
        <div id="notes-page">
            <h2>Notes</h2>
            <div id="notes-list"></div>
            <button onclick="showNoteForm()">Add Note</button>
            <div id="note-form" class="hidden">
                <h3>New Note</h3>
                <input type="text" id="note-title" placeholder="Title"><br>
                <textarea id="note-content" placeholder="Content"></textarea><br>
                <button onclick="saveNote()">Save Note</button>
            </div>
        </div>
        <div id="tasks-page" class="hidden">
            <h2>Tasks</h2>
            <div id="tasks-list"></div>
            <button onclick="showTaskForm()">Add Task</button>
            <div id="task-form" class="hidden">
                <h3>New Task</h3>
                <input type="text" id="task-desc" placeholder="Description"><br>
                <input type="date" id="task-due-date"><br>
                <button onclick="saveTask()">Save Task</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
        let notes = JSON.parse(localStorage.getItem('notes')) || [];
        let tasks = JSON.parse(localStorage.getItem('tasks')) || [];

        function showPage(page) {
            document.getElementById('notes-page').classList.add('hidden');
            document.getElementById('tasks-page').classList.add('hidden');
            document.getElementById(page + '-page').classList.remove('hidden');
            if (page === 'notes') {
                displayNotes();
            } else if (page === 'tasks') {
                displayTasks();
            }
        }

        function displayNotes() {
            const notesList = document.getElementById('notes-list');
            notesList.innerHTML = '';
            notes.forEach(note => {
                const noteDiv = document.createElement('div');
                noteDiv.innerHTML = `
                    <h3>${note.title}</h3>
                    <div>${marked(note.content)}</div>
                    <button onclick="editNote(${note.id})">Edit</button>
                    <button onclick="deleteNote(${note.id})">Delete</button>
                `;
                notesList.appendChild(noteDiv);
            });
        }

        function showNoteForm(note) {
            document.getElementById('note-form').classList.remove('hidden');
            if (note) {
                document.getElementById('note-title').value = note.title;
                document.getElementById('note-content').value = note.content;
            } else {
                document.getElementById('note-title').value = '';
                document.getElementById('note-content').value = '';
            }
        }

        function saveNote() {
            const title = document.getElementById('note-title').value;
            const content = document.getElementById('note-content').value;
            const note = { id: Date.now(), title, content, tasks: [] };
            notes.push(note);
            localStorage.setItem('notes', JSON.stringify(notes));
            document.getElementById('note-form').classList.add('hidden');
            displayNotes();
        }

        function editNote(id) {
            const note = notes.find(n => n.id === id);
            showNoteForm(note);
            notes = notes.filter(n => n.id !== id);
        }

        function deleteNote(id) {
            notes = notes.filter(n => n.id !== id);
            localStorage.setItem('notes', JSON.stringify(notes));
            displayNotes();
        }

        function displayTasks() {
            const tasksList = document.getElementById('tasks-list');
            tasksList.innerHTML = '';
            tasks.forEach(task => {
                const taskDiv = document.createElement('div');
                taskDiv.innerHTML = `
                    <input type="checkbox" ${task.isDone ? 'checked' : ''} onclick="toggleTaskDone(${task.id})">
                    <span class="${task.isDone ? 'task-done' : ''}">${task.description}</span>
                    <span>${task.dueDate ? new Date(task.dueDate).toLocaleDateString() : ''}</span>
                    <button onclick="editTask(${task.id})">Edit</button>
                    <button onclick="deleteTask(${task.id})">Delete</button>
                `;
                tasksList.appendChild(taskDiv);
            });
        }

        function showTaskForm(task) {
            document.getElementById('task-form').classList.remove('hidden');
            if (task) {
                document.getElementById('task-desc').value = task.description;
                document.getElementById('task-due-date').value = task.dueDate;
            } else {
                document.getElementById('task-desc').value = '';
                document.getElementById('task-due-date').value = '';
            }
        }

        function saveTask() {
            const description = document.getElementById('task-desc').value;
            const dueDate = document.getElementById('task-due-date').value;
            const task = { id: Date.now(), description, isDone: false, dueDate };
            tasks.push(task);
            localStorage.setItem('tasks', JSON.stringify(tasks));
            document.getElementById('task-form').classList.add('hidden');
            displayTasks();
        }

        function toggleTaskDone(id) {
            const task = tasks.find(t => t.id === id);
            task.isDone = !task.isDone;
            localStorage.setItem('tasks', JSON.stringify(tasks));
            displayTasks();
        }

        function editTask(id) {
            const task = tasks.find(t => t.id === id);
            showTaskForm(task);
            tasks = tasks.filter(t => t.id !== id);
        }

        function deleteTask(id) {
            tasks = tasks.filter(t => t.id !== id);
            localStorage.setItem('tasks', JSON.stringify(tasks));
            displayTasks();
        }

        // Initial display
        showPage('notes');
    </script>
</body>
</html>
